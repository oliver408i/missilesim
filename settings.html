<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Difficulty settings</title>
    <style>
        label {
            font-weight: bold;
            color: white;
        }
        p {
            color: white;
        }
        h3 {
            color: white;
        }
        
        /* Hide scrollbar for Chrome, Safari and Opera */
        ::-webkit-scrollbar {
            width: 5px;
        }
        
        /* Track */
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        
        /* Handle */
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.5);
            border-radius: 5px;
        }
        
        /* Handle on hover */
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 1);
        }
        
        /* Handle on set */
        ::-webkit-scrollbar-thumb:active {
            background: rgba(255, 255, 255, 0.8);
        }
        
        /* Handle on set */
        ::-webkit-scrollbar-thumb:window-inactive {
            background: rgba(255, 255, 255, 0.4);
        }
        
    </style>
</head>
<body>
    <form id="dropdownForm">
        <h3>Missile Settings</h3>
        <label for="irccm">IRCCM</label>
        <p>IRCCM mode. Outliner draws wireframes around flares of a certain temperature or higher.</p>
        <select id="irccm" name="irccm">
            <option value="None">None</option>
            <option value="outliner">Flare Outliner</option>
        </select>
        <br><br>
        
        <label for="proxyFuse">Proxy Fuse</label>
        <p>Proxy fuse will automatically detonate the missile once it gets in a certain distance of a certain object. Auto targetting will only target the actual object. Rangefinder mode will detonate the missile when the rangefinder encounters any close object. Rangefinder mode only works if the rangefinder is in front-linear mode</p>
        <select id="proxyFuse" name="proxyFuse">
            <option value="None">Off</option>
            <option value="autoTargetting">Auto Targetting</option>
            <option value="laser">Rangefinder</option>
        </select>

        <br><br>

        <label for="rangefinderMode">Rangefinder Mode</label>
        <p>The laser rangefinder will display how far away an object is. Linear mode looks for the closest object directly in front of the missile. Omnidirectional finds the closest object in all directions.</p>
        <select id="rangefinderMode" name="rangefinderMode">
            <option value="None">Off</option>
            <option value="linear">Front-Linear</option>
            <option value="omni">Omnidirectional</option>
        </select>

        <br><br>

        
        <label for="proxyFuseDistance">Proxy Fuse Distance</label>
        <p>Distance in meters at which the missile will automatically detonate. Affects all proxy fuse modes.</p>
        <input type="number" id="proxyFuseDistance" name="proxyFuseDistance" min="1" max="10" value="5"/>
        <br><br>

        <label for="sight">Sight</label>
        <p>Which sight to use</p>
        <select id="sight" name="sight">
            <option value="sight">Default Full Sight</option>
            <option value="cleansight">Minimal Sight</option>
            <option value="crosshair">Crosshair Only</option>
        </select>

        <br><br>

        <h3>Difficulty Settings</h3>
        <label for="targetDistance">Target Distance</label>
        <p>How far away should the target spawn.</p>
        <input type="number" id="targetDistance" name="targetDistance" min="100" max="500" value="200"/>
        
        <br><br>

        <label for="distanceThreshold">Distance Threshold</label>
        <p>How close the missile needs to be to the target when it explodes to count as a hit.</p>
        <input type="number" id="distanceThreshold" name="distanceThreshold" min="2" max="20" value="10"/>

        <br><br>

        <label for="missThreshold">Miss Time Threshold</lable>
        <p>How long in seconds the target can be out of the missile's FOV until it is considered missed.</p>
        <input type="number" id="missThreshold" name="missThreshold" min="0" max="5" value="2"/>

        <br><br>

        <label for="flareChance">Flare Chance</label>
        <p>Chance for a flare burst to be deployed every tick.</p>
        <input type="number" id="flareChance" name="flareChance" min="0" max="0.1" value="0.02"/>

        <br><br>

        <label for="flareCount">Flare Max Count</label>
        <p>How many flares (at max) can be deployed by the target.</p>
        <input type="number" id="flareCount" name="flareCount" min="1" max="20" value="10"/>
    
    </form>

    <script>
        // Load old settings if they exist
        if (localStorage.getItem('missileSpecs')) {
            const data = JSON.parse(localStorage.getItem('missileSpecs'));
            const difficultyData = JSON.parse(localStorage.getItem('difficultyData'));

            document.getElementById('irccm').value = data.irccmMode;
            document.getElementById('proxyFuse').value = data.proxyFuse;
            document.getElementById('proxyFuseDistance').value = data.proxyFuseDistance;
            document.getElementById('rangefinderMode').value = data.rangefinderMode;
            document.getElementById('sight').value = data.sightImage;

            document.getElementById('targetDistance').value = difficultyData.targetDistance;
            document.getElementById('distanceThreshold').value = difficultyData.distanceThreshold;
            document.getElementById('flareChance').value = difficultyData.flareChance;
            document.getElementById('flareCount').value = difficultyData.flareCount;
            document.getElementById('missThreshold').value = difficultyData.missThreshold;
        }

        function saveToLocalStorage() {
            console.log("Saving settings");
            const irccm = document.getElementById('irccm').value;
            const proxyFuse = document.getElementById('proxyFuse').value;
            const proxyFuseDistance = document.getElementById('proxyFuseDistance').value;
            const rangefinderMode = document.getElementById('rangefinderMode').value;
            const sight = document.getElementById('sight').value;

            const difficultyData = {
                targetDistance: document.getElementById('targetDistance').value,
                distanceThreshold: document.getElementById('distanceThreshold').value,
                flareChance: document.getElementById('flareChance').value,
                flareCount: document.getElementById('flareCount').value,
                missThreshold: document.getElementById('missThreshold').value
            };
            localStorage.setItem('difficultyData', JSON.stringify(difficultyData));

            const data = {
                irccmMode: irccm,
                proxyFuse: proxyFuse,
                proxyFuseDistance: proxyFuseDistance,
                rangefinderMode: rangefinderMode,
                sightImage: sight

            };
            
            localStorage.setItem('missileSpecs', JSON.stringify(data));
            window.parent.postMessage("startGame");
        }
    </script>
</body>
</html>